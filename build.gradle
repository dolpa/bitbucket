/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn how to create Gradle builds at https://guides.gradle.org/creating-new-gradle-builds
 */
plugins {
    id 'com.palantir.docker' version '0.25.0'
}

def docker_hub_repo = 'dolpa'

if (!project.hasProperty("version")) {
  ext.version = "7.5.0"
  println "version: ${version}"
}

if (!project.hasProperty("app_version")) {
  ext.app_version = "7.5.0"
  println "App Version: ${app_version}"
}

println "Version: ${version}"
println "App Version: ${app_version}"

docker {
    name "${docker_hub_repo}/${project.name}:${version}"
    tag '-version', "${docker_hub_repo}/${project.name}:${project.version}"
    tag '-latest', "${docker_hub_repo}/${project.name}:latest"
    dockerfile file('Dockerfile')
    files "start-bitbucket-docker.sh"
    buildArgs([version: "${version}", app_version: "${app_version}"])
    labels(['app': "${project.name}", 
            'app-version': "${version}"])
    pull true
    noCache true
}